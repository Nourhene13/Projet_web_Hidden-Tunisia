{% extends "basefrontparid.html.twig" %}
{% block body %}
	<section class="page-title" style="background-image:url(../front/images/background/5.jpg)">
		<div class="auto-container">
			<h2>Blog Details</h2>
			<ul class="page-breadcrumb">
				<li>
					<a href="index-2.html">home</a>
				</li>
				<li>Blog Details</li>
			</ul>
		</div>
	</section>
	<div class="sidebar-page-container">
		<div class="auto-container">
			<div
				class="row clearfix">


				<!--Content Side / Blog Classic -->
				<div class="content-side col-xl-9 col-lg-8 col-md-12 col-sm-12">
					<div class="blog-single padding-right">
						<div class="inner-box">
							<div class="image-box">
								<figure class="image"><img src="{{asset('uploads/images/'~ data.getImage() )}}" alt=""></figure>
								<span class="date">{{ data.getCreatedAt()|date("m/d/Y") }}</span>
							</div>
							<div class="lower-content">
								<div class="post-meta">
									<ul class="post-info clearfix">
										<li>
											<a href="{{ path('blog_details', {'id': data.id}) }}">By :
												{{ data.getUtilisateur() ? data.getUtilisateur().getNomUser() : ''  }}</a>
										</li>
										<li>
											<a href="{{ path('blog_details', {'id': data.id}) }}">{{ data.getCategory() }}</a>
										</li>
										<li>
											<a href="{{ path('blog_details', {'id': data.id}) }}">Comments:
												{{ data1|length }}</a>
										</li>

									</ul>
								</div>
								<div class="lower-box">
									<h3>{{ data.getTitle() }}</h3>
									<div class="text">
										<p>{{ data.getContent() }}</p>
									</div>
								</div>
							</div>
						</div>


						<!--Comments Area-->
						<div class="comments-area">
							<div class="group-title">
								<h2></h2>
							</div>
							<div
								class="inner-box">
								<!--Comment Box-->


								{% for item in data1 %}
									<div class="comment-box" id="comment-{{ item.id }}">
										<div class="comment">
											<div class="author-thumb"><img src="../images/resource/author-1.jpg" alt=""></div>
											<div class="comment-inner">
												<div class="comment-info clearfix">
													<strong>{{ item.getUtilisateur() ? item.getUtilisateur().getNomUser() : ''  }}
														{{ item.getUtilisateur() ? item.getUtilisateur().getPrenomUser() : ''  }}</strong>
												</div>
												<div class="text">{{ item.getContent() }}</div>
												<ul class="post-info">
													<li>{{ item.getCreatAt|date("m/d/Y") }}</li>
												</ul>
											</div>
										</div>
										<div class="like-container">
											<div>
												<span class="like-icon">
													<i class="fa fa-heart"></i>
												</span>
												<button class="like-button" data-comment-id="{{ item.id }}">Like</button>
												<span class="like-count">{{ item.getLikes() }}</span>
											</div>
											<div class="dislike-container">
												<span class="dislike-icon">
													<i class="fa fa-thumbs-down"></i>
												</span>
												<button class="dislike-button" data-comment-id="{{ item.id }}">Dislike</button>
												<span class="dislike-count">{{ item.getDislikes() }}</span>
											</div>
										</div>
									</div>
								{% endfor %}

								{% block javascripts %}
									<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
									<script src="{{ asset('js/script.js') }}"></script>
									<script>
										$(document).ready(function () {
$(".like-button, .dislike-button").on("click", function (e) {
e.preventDefault();
var $this = $(this);
var commentId = $this.data("comment-id");
var isLike = $this.hasClass("like-button");
var isDislike = $this.hasClass("dislike-button");
$.ajax({
url: "{{ path('update_likes') }}",
type: "POST",
data: {
commentId: commentId,
isLike: isLike,
isDislike: isDislike
},
success: function (data) {
if (data.success) {
var $likeCount = $this.siblings(".like-count");
var $dislikeCount = $this.siblings(".dislike-count");
$likeCount.text(data.likes);
$dislikeCount.text(data.dislikes);
}
}
});
});
});
									</script>
								{% endblock %}


							</div>
						</div>

						<!-- Comment Form -->
						<div class="comment-form">
							<div class="group-title">
								<h2>Leave a Comment</h2>
							</div>
							<div
								class="form-inner">
								<!--Comment Form-->
								<form method="post" action="#">
									<div class="row clearfix">
										{{ form_start(form) }}
										<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 form-group">
											{{ form_label(form.content) }}
											{{ form_widget(form.content,{'attr':{'placeholder':'Write message'}}) }}
											<button class="theme-btn submit-btn" href="{{ path('blog_details', {'id': data.id}) }}">Post Comment</button>
										</div>
										{{ form_end(form) }}

									</div>
								</form>
							</div>
						</div>
						<!--End Comment Form -->

					</div>
				</div>
			</div>
		</div>
	</div>
{% endblock %}
